<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Career Counselor Bot</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

<style>
*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:"Inter",sans-serif;
}

body{
display:flex;
height:100vh;
background:linear-gradient(135deg,#eef2ff,#f8fafc);
overflow:hidden;
}

/* Sidebar */
.sidebar{
width:270px;
background:#0f172a;
color:white;
display:flex;
flex-direction:column;
padding:20px;
}

.sidebar h2{
font-size:18px;
margin-bottom:18px;
}

.new-chat{
padding:12px;
background:linear-gradient(135deg,#2563eb,#4f46e5);
border:none;
border-radius:12px;
color:white;
cursor:pointer;
margin-bottom:18px;
transition:0.3s;
}

.new-chat:hover{
transform:translateY(-2px);
box-shadow:0 8px 20px rgba(79,70,229,0.4);
}

.chat-list{
flex:1;
overflow-y:auto;
}

.chat-item{
padding:10px;
border-radius:10px;
cursor:pointer;
font-size:14px;
color:#cbd5e1;
transition:0.2s;
}

.chat-item:hover{
background:#1e293b;
}

.chat-item.active{
background:#334155;
}

/* Main */
.main{
flex:1;
display:flex;
flex-direction:column;
background:white;
}

.header{
padding:20px 30px;
font-weight:600;
border-bottom:1px solid #e5e7eb;
}

.chat-container{
flex:1;
padding:40px 60px;
overflow-y:auto;
display:flex;
flex-direction:column;
}

.message{
max-width:55%;
padding:16px 18px;
border-radius:18px;
margin-bottom:18px;
font-size:14px;
line-height:1.6;
animation:fadeIn 0.3s ease;
}

@keyframes fadeIn{
from{opacity:0;transform:translateY(10px);}
to{opacity:1;transform:translateY(0);}
}

.user{
background:linear-gradient(135deg,#2563eb,#4f46e5);
color:white;
align-self:flex-end;
border-bottom-right-radius:6px;
}

.bot{
background:#f1f5f9;
color:#111827;
align-self:flex-start;
border-bottom-left-radius:6px;
}

.input-area{
padding:25px 50px;
border-top:1px solid #e5e7eb;
display:flex;
gap:12px;
}

.input-area input{
flex:1;
padding:16px;
border-radius:16px;
border:1px solid #d1d5db;
font-size:14px;
}

.input-area input:focus{
outline:none;
border-color:#2563eb;
box-shadow:0 0 0 4px rgba(37,99,235,0.15);
}

.input-area button{
padding:16px 22px;
border-radius:16px;
border:none;
background:linear-gradient(135deg,#2563eb,#4f46e5);
color:white;
cursor:pointer;
transition:0.3s;
}

.input-area button:hover{
transform:translateY(-2px);
box-shadow:0 8px 20px rgba(79,70,229,0.35);
}
</style>
</head>

<body>

<div class="sidebar">
<h2>Career Counselor Bot</h2>
<button class="new-chat" onclick="createNewChat()">+ New Chat</button>
<div class="chat-list" id="chatList"></div>
</div>

<div class="main">
<div class="header">AI Career Counselor</div>
<div class="chat-container" id="chatContainer"></div>

<div class="input-area">
<input type="text" id="userInput" placeholder="Ask about careers...">
<button onclick="sendMessage()">Send</button>
</div>
</div>

<script>
let chats = JSON.parse(localStorage.getItem("careerChats")) || {};
let currentChatId = null;

function saveChats(){
localStorage.setItem("careerChats",JSON.stringify(chats));
}

function createNewChat(){
const id="chat_"+Date.now();
chats[id]=[];
currentChatId=id;
saveChats();
renderChatList();
renderMessages();
botIntro();
}

function botIntro(){
addMessage("bot","Hi ðŸ‘‹ I'm your Career Counselor Bot. How can I help you today?");
}

function renderChatList(){
const chatList=document.getElementById("chatList");
chatList.innerHTML="";
Object.keys(chats).forEach(id=>{
const div=document.createElement("div");
div.className="chat-item"+(id===currentChatId?" active":"");
div.innerText=chats[id][0]?.text?.slice(0,28)||"New Conversation";
div.onclick=()=>{currentChatId=id;renderChatList();renderMessages();};
chatList.appendChild(div);
});
}

function renderMessages(){
const container=document.getElementById("chatContainer");
container.innerHTML="";
if(!currentChatId)return;
chats[currentChatId].forEach(msg=>{
displayMessage(msg.sender,msg.text);
});
container.scrollTop=container.scrollHeight;
}

function addMessage(sender,text){
chats[currentChatId].push({sender,text});
saveChats();
displayMessage(sender,text);
renderChatList();
}

function displayMessage(sender,text){
const container=document.getElementById("chatContainer");
const div=document.createElement("div");
div.className="message "+sender;
div.innerText=text;
container.appendChild(div);
container.scrollTop=container.scrollHeight;
}

async function sendMessage(){
const input=document.getElementById("userInput");
const text=input.value.trim();
if(!text||!currentChatId)return;

addMessage("user",text);
input.value="";

try{
const response = await fetch("http://127.0.0.1:8000/chat", {
method: "POST",
headers: { "Content-Type": "application/json" },
body: JSON.stringify({ message: text })
});

const data = await response.json();
addMessage("bot", data.response);

}catch(error){
addMessage("bot","Unable to connect to backend at 127.0.0.1:8000");
}
}

document.getElementById("userInput").addEventListener("keypress",function(e){
if(e.key==="Enter"){sendMessage();}
});

if(Object.keys(chats).length===0){
createNewChat();
}else{
currentChatId=Object.keys(chats)[0];
renderChatList();
renderMessages();
}
</script>

</body>
</html>
